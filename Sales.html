<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Sales Dashboard</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating Vinzzy">
		<meta name="author" content="Vinit Ganatra">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		<script src="https://public.tableau.com/javascripts/api/tableau-2.min.js" type="text/javascript"></script> 

</head>	

<body onload=initializeViz();>
<h1>"Sales Dashboard"</h1>
Say: <b><i>"Select Ohio"</i>,<i>"Export"</i>,<i>"Remove selections"</i>,<i>"Start Over"</i></b>
<br>
<br>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
 var commands = {
	'select Alabama': function() { selectAlabama(); responsiveVoice.speak('selecting Alabama', 'UK English Male'); },
	'select Arizona': function() { selectArizona(); responsiveVoice.speak('selecting Arizona', 'UK English Male'); },
	'select Arkansas': function() { selectArkansas(); responsiveVoice.speak('selecting Arkansas', 'UK English Male'); },
	'select California': function() { selectCalifornia(); responsiveVoice.speak('selecting California', 'UK English Male'); },
	'select Colorado': function() { selectColorado(); responsiveVoice.speak('selecting Colorado', 'UK English Male'); },
	'select Connecticut': function() { selectConnecticut(); responsiveVoice.speak('selecting Connecticut', 'UK English Male'); },
	'select Delaware': function() { selectDelaware(); responsiveVoice.speak('selecting Delaware', 'UK English Male'); },
	'select District of Columbia': function() { selectDistrictofColumbia(); responsiveVoice.speak('selecting District of Columbia', 'UK English Male'); },
	'select Florida': function() { selectFlorida(); responsiveVoice.speak('selecting Florida', 'UK English Male'); },
	'select Georgia': function() { selectGeorgia(); responsiveVoice.speak('selecting Georgia', 'UK English Male'); },
	'select Idaho': function() { selectIdaho(); responsiveVoice.speak('selecting Idaho', 'UK English Male'); },
	'select Illinois': function() { selectIllinois(); responsiveVoice.speak('selecting Illinois', 'UK English Male'); },
	'select Indiana': function() { selectIndiana(); responsiveVoice.speak('selecting Indiana', 'UK English Male'); },
	'Remove Selections': function() { removeFilter();responsiveVoice.speak('Removing selections', 'UK English Male'); },
	'export': function() { exportPDF(); responsiveVoice.speak('exporting', 'UK English Male'); },
	'start over': function() { startover(); responsiveVoice.speak('starting over', 'UK English Male'); }
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening.
  annyang.start();
}
</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://public.tableau.com/views/SalesDashboard_414/Dashboard1?:embed=y&:display_count=yes&publish=yes";
var options = {
   width: "1200",   
   height: "1000",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}


responsiveVoice.speak('Hi. How may I help you?','UK English Male');

//Make state selection
function selectAlabama()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Alabama', 'REPLACE');
}
function selectArizona()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Arizona', 'REPLACE');
}
function selectArkansas()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Arkansas', 'REPLACE');
}
function selectCalifornia()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'California', 'REPLACE');
}
function selectColorado()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Colorado', 'REPLACE');
}
function selectConnecticut()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Connecticut', 'REPLACE');
}
function selectDelaware()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Delaware', 'REPLACE');
}
function selectDistrictofColumbia()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'District of Columbia', 'REPLACE');
}
function selectFlorida()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Florida', 'REPLACE');
}
function selectGeorgia()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Georgia', 'REPLACE');
}
function selectIdaho()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Idaho', 'REPLACE');
}
function selectIllinois()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Illinois', 'REPLACE');
}
function selectIndiana()
{
activeSheet.getWorksheets()[0].selectMarksAsync('State', 'Indiana', 'REPLACE');
}

function removeFilter()
	{
	viz.revertAllAsync();
	}
function exportPDF()
	{
	viz.showExportPDFDialog();
	}
function startover()
	{
	window.location.replace("https://sharat543.github.io/Initial.html");
	}
	
</script>
</body>
</html>		
		
		