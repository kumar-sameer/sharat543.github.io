<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>College Admissions Dashboard</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating Vinzzy">
		<meta name="author" content="Vinit Ganatra">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		<script src="https://public.tableau.com/javascripts/api/tableau-2.min.js" type="text/javascript"></script> 

</head>	

<body onload=initializeViz();>
<h1>"College Admissions Dashboard"</h1>
Say: <i>"Select Music"</i>,<i>"Export"</i>,<i>"Remove filter"</i>,<i>"Start Over"</i>
<br>
<br>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
 var commands = {
  	'Select Arts': function() { selectArts(); responsiveVoice.speak('selecting Arts', 'UK English Male'); },
 	'Select Business': function() { selectBusiness(); responsiveVoice.speak('selecting Business', 'UK English Male'); },
 	'Select Communication': function() { selectCommunication(); responsiveVoice.speak('selecting Communication', 'UK English Male'); },
 	'Select Education': function() { selectEducation(); responsiveVoice.speak('selecting Education', 'UK English Male'); },
	'Select Engineering': function() { selectEngineering(); responsiveVoice.speak('selecting Engineering', 'UK English Male'); },
	'Select Music': function() { selectMusic(); responsiveVoice.speak('selecting Music', 'UK English Male'); },
	'Select Public Affairs': function() { selectPA(); responsiveVoice.speak('selecting Public Affairs', 'UK English Male'); },
	'Select Public Health': function() { selectPH(); responsiveVoice.speak('selecting Public Health', 'UK English Male'); },
	'Filter Arts': function() { filterArts(); responsiveVoice.speak('Filtering Arts', 'UK English Male'); },
	'Filter Business': function() { filterBusiness(); responsiveVoice.speak('Filtering Business', 'UK English Male'); },
	'Filter Communication': function() { filterCommunication(); responsiveVoice.speak('Filtering Communication', 'UK English Male'); },
	'Remove Filter': function() { removeFilter();responsiveVoice.speak('Removing Filters', 'UK English Male'); },
	'export': function() { exportPDF(); responsiveVoice.speak('exporting', 'UK English Male'); },
	'start over': function() { startover(); responsiveVoice.speak('starting over', 'UK English Male'); }
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening.
  annyang.start();
}
</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://public.tableau.com/views/RegionalSampleWorkbook/College?:embed=y&:display_count=yes";
var options = {
   width: "1004",   
   height: "869",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}


responsiveVoice.speak('Hi. How may I help you?','UK English Male');

//Make College selection
function selectArts()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Arts & Sciences', 'REPLACE'); 
	}

function selectBusiness()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Business', 'REPLACE'); 
	}

function selectCommunication()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Communication', 'REPLACE'); 
	}	

function selectEducation()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Education', 'REPLACE'); 
	}
	
function selectEngineering()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Engineering', 'REPLACE'); 
	}
	
function selectMusic()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Music', 'REPLACE'); 
	}
	
function selectPA()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Public Affairs', 'REPLACE'); 
	}
	
function selectPH()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('College', 'Public Health', 'REPLACE'); 
	}
	
function filterArts()
	{
	activeSheet.getWorksheets()[0].applyFilterAsync('College', 'Arts', tableauSoftware.FilterUpdateType.REPLACE); 
	}
	
function filterBusiness()
   	{
   	activeSheet.getWorksheets()[0].applyFilterAsync('College', 'Business', tableauSoftware.FilterUpdateType.REPLACE); 
   	}
	
function filterCommunication()
    	{
   	activeSheet.getWorksheets()[0].applyFilterAsync('College', 'Communication', tableauSoftware.FilterUpdateType.REPLACE); 
   	}
	
function removeFilter()
	{
	viz.revertAllAsync();
	}
function exportPDF()
	{
	viz.showExportPDFDialog();
	}
function startover()
	{
	window.location.replace("https://sharat543.github.io/Initial.html");
	}
	
</script>
</body>
</html>		
		
		