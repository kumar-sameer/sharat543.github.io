<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Tableau Voice Control</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating dashboard">
		<meta name="author" content="Sarat Varanasi">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		<script src="https://public.tableau.com/javascripts/api/tableau-2.min.js" type="text/javascript"></script> 

</head>	

<body onload=initializeViz();>
<h1>Public Transportation in Europe </h1>
Say: <i>"Select Austria"</i>,<i>"Export"</i>,<i>"Remove selections"</i>,<i>"Start Over"</i>
<br>
<br>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
 var commands = {
  	'Select Switzerland': function() { selectSwiss(); responsiveVoice.speak('selecting Switzerland', 'UK English Male'); },
 	'Select Norway': function() { selectNorway(); responsiveVoice.speak('selecting Norway'); },
 	'Select Austria': function() { selectAustria(); responsiveVoice.speak('selecting Austria'); },
 	'Select Czech Republic': function() { selectCzech(); responsiveVoice.speak('selecting Czech Republic'); },
	'Select Germany': function() { selectGermany(); responsiveVoice.speak('selecting Germany'); },
	'Select Netherlands': function() { selectDutch(); responsiveVoice.speak('selecting Netherlands'); },
	'Select Bulgaria': function() { selectBulgaria(); responsiveVoice.speak('selecting Bulgaria'); },
	'Select Luxembourg': function() { selectLuxem(); responsiveVoice.speak('selecting Luxembourg'); },
	'Select Poland': function() { selectPoland(); responsiveVoice.speak('selecting Poland'); },
	'Select France': function() { selectFrance(); responsiveVoice.speak('selecting France'); },
	'Remove Selections': function() { RemoveSelections();responsiveVoice.speak('Removing Selections'); },
	'export': function() { exportPDF(); responsiveVoice.speak('exporting'); },
	'start over': function() { startover(); responsiveVoice.speak('starting over',); }
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening.
  annyang.start();
}
</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "http://10.118.20.96:8008/#/site/datavisualizationcoe/views/ChildCareExpenditureAnalysis/CCSExpenditureDashboard2?:iid=2";
var options = {
   width: "1004",   
   height: "869",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}

//dashboard says hello
responsiveVoice.speak('Hi. How may I help you?','UK English Male');

//Make country selection
function selectSwiss()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Switzerland', 'REPLACE'); 
	}

function selectNorway()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Norway', 'REPLACE'); 
	}

function selectAustria()
	{
	activeSheet.getWorksheets()[1].applyFilterAsync('Country', 'Austria', tableauSoftware.FilterUpdateType.REPLACE); 
	}	

function selectCzech()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Czech Republic', 'REPLACE'); 
	}
	
function selectGermany()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Germany', 'REPLACE'); 
	}
	
function selectDutch()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Netherlands', 'REPLACE'); 
	}
	
function selectBulgaria()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Bulgaria', 'REPLACE'); 
	}
	
function selectLuxem()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Luxembourg', 'REPLACE'); 
	}
	
function selectPoland()
	{
	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'Poland', 'REPLACE'); 
	}
	
function selectFrance()
        {
    	activeSheet.getWorksheets()[1].selectMarksAsync('Country', 'France', 'REPLACE'); 
    	}
	
function RemoveSelections()
{
viz.revertAllAsync();
}

function exportPDF()
{
viz.showExportPDFDialog();
}

//Start Viz Over
function startover()
{
window.location.replace("https://sharat543.github.io/Initial.html");
}
</script>
</body>
</html>		
		
		